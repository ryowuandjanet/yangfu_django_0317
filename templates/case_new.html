{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<h1>建立YF評量表</h1>
<form action="" method="post">{% csrf_token %}
    <div class="accordion" id="accordionExample">
        <!-- 基本資料 -->
        <div class="card">
            <div class="card-header" id="headingOne">
                <h2 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                        基本資料
                    </button>
                </h2>
            </div>
            <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordionExample">
                <div class="card-body">
                    <div class="form-group">
                        {{ form.casenumber|as_crispy_field }}
                    </div>
                    <div class="form-row">
                        <div class="col-md-2 mb-0">
                            {{ form.city|as_crispy_field }}
                        </div>
                        <div class="col-md-2 mb-0">
                            {{ form.township|as_crispy_field }}
                        </div>
                        <div class="col-md-2 mb-0">
                            {{ form.section|as_crispy_field }}
                        </div>
                        <div class="col-md-2 mb-0">
                            {{ form.small_section|as_crispy_field }}
                        </div>
                        <div class="col-md-4 mb-0">
                            {{ form.other_address|as_crispy_field}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 地號 -->
        <div class="card">
            <div class="card-header" id="headingTwo">
                <h2 class="mb-0">
                    <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="true" aria-controls="collapseOne">
                        土地
                    </button>
                </h2>
            </div>
            <div id="collapseTwo" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">
                <div class="card-body">
                    <table class="table">
                        {{ lands.management_form }}
                        {% for form in lands.forms %}
                        {% if forloop.first %}
                        <thead>
                            <tr>
                                {% for field in form.visible_fields %}
                                <th>{{ field.label|capfirst }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        {% endif %}
                        <tr class="{% cycle row1 row2 %} formset_row">
                            {% for field in form.visible_fields %}
                            <td>
                                {# Include the hidden fields in the form #}
                                {% if forloop.first %}
                                {% for hidden in form.hidden_fields %}
                                {{ hidden }}
                                {% endfor %}
                                {% endif %}
                                {{ field.errors.as_ul }}
                                {{ field }}
                            </td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
        <!-- 建物 -->
        <div class="card">
            <div class="card-header" id="headingThree">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                        建物
                    </button>
                </h2>
            </div>
            <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordionExample">
                <div class="card-body">
                    <table class="table">
                        {{ builds.management_form }}
                        {% for form in builds.forms %}
                        {% if forloop.first %}
                        <thead>
                            <tr>
                                {% for field in form.visible_fields %}
                                <th>{{ field.label|capfirst }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        {% endif %}
                        <tr class="{% cycle row1 row2 %} formset_row2">
                            {% for field in form.visible_fields %}
                            <td>
                                {# Include the hidden fields in the form #}
                                {% if forloop.first %}
                                {% for hidden in form.hidden_fields %}
                                {{ hidden }}
                                {% endfor %}
                                {% endif %}
                                {{ field.errors.as_ul }}
                                {{ field }}
                            </td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
        <!-- 拍賣資訊 -->
        <div class="card">
            <div class="card-header" id="headingFour">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                        拍賣資訊
                    </button>
                </h2>
            </div>
            <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordionExample">
                <div class="card-body">
                    <table class="table">
                        <div class="form-row">
                            <div class="form-group col-md-3 mb-0">
                                {{ form.auctionday1|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.floorprice1|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.click1|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.monitor1|as_crispy_field }}
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-3 mb-0">
                                {{ form.auctionday2|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.floorprice2|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.click2|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.monitor2|as_crispy_field }}
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-3 mb-0">
                                {{ form.auctionday3|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.floorprice3|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.click3|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.monitor3|as_crispy_field }}
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-3 mb-0">
                                {{ form.auctionday4|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.floorprice4|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.click4|as_crispy_field }}
                            </div>
                            <div class="form-group col-md-3 mb-0">
                                {{ form.monitor4|as_crispy_field }}
                            </div>
                        </div>
                    </table>
                </div>
            </div>
        </div>
        <!-- 人員 -->
        <div class="card">
            <div class="card-header" id="headingFive">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                        人員
                    </button>
                </h2>
            </div>
            <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordionExample">
                <div class="card-body">
                    <table class="table">
                        {{ personnals.management_form }}
                        {% for form in personnals.forms %}
                        {% if forloop.first %}
                        <thead>
                            <tr>
                                {% for field in form.visible_fields %}
                                <th>{{ field.label|capfirst }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        {% endif %}
                        <tr class="{% cycle row1 row2 %} formset_row3">
                            {% for field in form.visible_fields %}
                            <td>
                                {# Include the hidden fields in the form #}
                                {% if forloop.first %}
                                {% for hidden in form.hidden_fields %}
                                {{ hidden }}
                                {% endfor %}
                                {% endif %}
                                {{ field.errors.as_ul }}
                                {{ field }}
                            </td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
        <!-- 勘查記錄 -->
        <div class="card">
            <div class="card-header" id="headingSix">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix">
                        勘查記錄
                    </button>
                </h2>
            </div>
            <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-parent="#accordionExample">
                <div class="card-body">
                    <div class="form-group">
                        {{ form.first_surveydate|as_crispy_field }}
                    </div>
                    <div class="form-group">
                        {{ form.other_surveydate|as_crispy_field }}
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-4 mb-0">
                            {{ form.foreclosure_announcement_link|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-8 mb-0">
                            {{ form.foreclosure_announcement_text|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-4 mb-0">
                            {{ form.object_photos_link|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-8 mb-0">
                            {{ form.object_photos_text|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-4 mb-0">
                            {{ form.registration_market_price_link|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-8 mb-0">
                            {{ form.registration_market_price_text|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-4 mb-0">
                            {{ form.registration_map_link|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-8 mb-0">
                            {{ form.registration_map_text|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-4 mb-0">
                            {{ form.registration_phot_link|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-8 mb-0">
                            {{ form.registration_phot_text|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-4 mb-0">
                            {{ form.foreclosure_record_link|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-8 mb-0">
                            {{ form.foreclosure_record_text|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-group">
                        {{ form.survey_remark|as_crispy_field }}
                    </div>
                    <div class="form-group">
                        {{ form.survey_decision|as_crispy_field }}
                    </div>
                    <div class="form-group">
                        {{ form.final_decision|as_crispy_field }}
                    </div>
                </div>
            </div>
        </div>
        <!-- 物件查檢表 -->
        <div class="card">
            <div class="card-header" id="headingSeven">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseSeven" aria-expanded="false" aria-controls="collapseSeven">
                        物件查檢表
                    </button>
                </h2>
            </div>
            <div id="collapseSeven" class="collapse" aria-labelledby="headingSeven" data-parent="#accordionExample">
                <div class="card-body">
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.occupyneighbouringland|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.register|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.parkingspace|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.managementfee|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.occupy|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.leak|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.easyparking|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.railway|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.vegetablemarket|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.store|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.school|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.park|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.postoffice|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.mainroad|as_crispy_field }}
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group col-md-6 mb-0">
                            {{ form.waterandpowerfailure|as_crispy_field }}
                        </div>
                        <div class="form-group col-md-6 mb-0">
                            {{ form.goodvision|as_crispy_field }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 物件 -->
        <div class="card">
            <div class="card-header" id="headingEight">
                <h2 class="mb-0">
                    <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseEight" aria-expanded="false" aria-controls="collapseEight">
                        待勘查物件
                    </button>
                </h2>
            </div>
            <div id="collapseEight" class="collapse" aria-labelledby="headingEight" data-parent="#accordionExample">
                <div class="card-body">
                    <table class="table">
                        {{ objectbuilds.management_form }}
                        {% for form in objectbuilds.forms %}
                        {% if forloop.first %}
                        <thead>
                            <tr>
                                {% for field in form.visible_fields %}
                                <th>{{ field.label|capfirst }}</th>
                                {% endfor %}
                            </tr>
                        </thead>
                        {% endif %}
                        <tr class="{% cycle row1 row2 %} formset_row4">
                            {% for field in form.visible_fields %}
                            <td>
                                {# Include the hidden fields in the form #}
                                {% if forloop.first %}
                                {% for hidden in form.hidden_fields %}
                                {{ hidden }}
                                {% endfor %}
                                {% endif %}
                                {{ field.errors.as_ul }}
                                {{ field }}
                            </td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </table>
                </div>
            </div>
        </div>
    </div>
    <input type="submit" value="儲存後離開" class="btn btn-primary" />
    <a href="{% url 'case_list' %}" class="btn btn-info">返回首頁</a>
    <!-- <button class="btn btn-success ml-2 " type="submit">Save</button> -->
</form>
{% endblock %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="{% static 'formset/jquery.formset.js' %}"></script>
<script type="text/javascript">
$('.formset_row').formset({
    addText: '新增地號',
    deleteText: '刪除',
    prefix: 'land_set'
});
$('.formset_row2').formset({
    addText: '新增建號',
    deleteText: '刪除',
    prefix: 'build_set'
});
$('.formset_row3').formset({
    addText: '新增人員',
    deleteText: '刪除',
    prefix: 'personnal_set'
});
$('.formset_row4').formset({
    addText: '新增物件',
    deleteText: '刪除',
    prefix: 'objectbuild_set'
});
</script>